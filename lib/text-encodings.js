// Generated by CoffeeScript 1.6.3
var Iconv, UnicodeDecodeError, convert, decode;

Iconv = require('iconv').Iconv;

UnicodeDecodeError = require('./errors').UnicodeDecodeError;

decode = {
  latin1: new Iconv('ISO-8859-1', 'UTF-8'),
  utf16: new Iconv('UTF-16', 'UTF-8'),
  utf16be: new Iconv('UTF-16BE', 'UTF-8'),
  utf8: {
    convert: function(buffer) {
      return buffer;
    }
  }
};

convert = function(buffer) {
  return {
    from: function(encoding) {
      var err, _ref;
      convert = (_ref = decode[encoding]) != null ? _ref.convert : void 0;
      if (!convert) {
        throw new UnicodeDecodeError("Conversion from " + encoding + " unsupported");
      }
      try {
        return (convert(buffer)).toString();
      } catch (_error) {
        err = _error;
        throw new UnicodeDecodeError(err.message || err);
      }
    }
  };
};

module.exports = convert;
